<!-- app.component.ts -->
<ng-template #fullMenuContent>
  <div class="flex flex-column h-full justify-content-between">
    <div class="flex flex-column gap-2">
      <div class="mb-2 px-3 flex align-items-center gap-2 font-bold text-xl text-blue-600">
          <i class="pi pi-briefcase"></i>
          <span>FastPass Admin</span>
      </div>

      <div class="px-3 mb-3">
        <p-dropdown 
          [options]="siteOptions" 
          [(ngModel)]="selectedSite" 
          optionLabel="label" 
          optionValue="value" 
          styleClass="w-full text-sm"
          placeholder="Select Site"
          appendTo="body">
        </p-dropdown>
      </div>

      <div *ngFor="let item of topMenu"
           class="p-ripple flex align-items-center p-3 border-round-md cursor-pointer text-700 transition-colors transition-duration-150 hover:surface-100"
           [class.surface-100]="isActive(item.route)"
           [class.text-primary]="isActive(item.route)"
           [class.font-bold]="isActive(item.route)"
           (click)="navigate(item.route); sidebarVisible = false"> 
           <i [class]="item.icon" class="text-xl mr-2"></i>
        <span class="font-medium">{{ item.label }}</span>
      </div>
    </div>

    <div class="flex flex-column gap-2">
      <div *ngFor="let item of bottomMenu"
           class="p-ripple flex align-items-center p-3 border-round-md cursor-pointer text-700 transition-colors transition-duration-150 hover:surface-100"
           (click)="navigate(item.route); sidebarVisible = false">
           <i [class]="item.icon" class="text-xl mr-2"></i>
        <span class="font-medium">{{ item.label }}</span>
      </div>
      <p-divider></p-divider>
      <div class="flex align-items-center gap-3 px-2 py-1">
        <p-avatar image="https://primefaces.org/cdn/primeng/images/demo/avatar/amyelsner.png" shape="circle" size="large"></p-avatar>
        <div class="flex flex-column">
            <span class="font-bold text-sm">Amy Elsner</span>
            <span class="text-500 text-xs">Admin</span>
        </div>
      </div>
    </div>
  </div>
</ng-template>

<div class="flex h-screen overflow-hidden surface-ground">
  
  <div class="hidden md:flex flex-column align-items-center h-full py-4 bg-white shadow-2 flex-shrink-0 z-5" style="width: 5.5rem;">
    
    <div class="mb-2 flex align-items-center justify-content-center w-3rem h-3rem border-round-xl bg-blue-50 text-blue-600 cursor-pointer hover:bg-blue-100 transition-colors"
         (click)="sidebarVisible = true" pTooltip="Expand Menu" tooltipPosition="right">
        <i class="pi pi-briefcase text-2xl"></i>
    </div>

    <div class="mb-4 flex align-items-center justify-content-center w-3rem h-3rem border-round-xl bg-orange-50 text-orange-600 cursor-pointer hover:bg-orange-100 transition-colors"
         (click)="siteOverlay.toggle($event)" 
         [pTooltip]="currentSiteLabel" 
         tooltipPosition="right">
        <i class="pi pi-globe text-xl"></i>
    </div>

    <div class="flex flex-column gap-3 w-full">
        <div *ngFor="let item of topMenu"
             class="p-ripple flex align-items-center justify-content-center w-3rem h-3rem mx-auto border-round-xl cursor-pointer transition-all transition-duration-200"
             [ngClass]="isActive(item.route) ? 'bg-blue-600 text-white shadow-2' : 'text-500 hover:bg-gray-100 hover:text-700'"
             [pTooltip]="item.label" 
             tooltipPosition="right"
             (click)="navigate(item.route)">
             <i [class]="item.icon" class="text-xl"></i>
        </div>
    </div>

    <div class="flex-grow-1"></div>

    <div class="flex flex-column gap-3 w-full align-items-center">
        <div *ngFor="let item of bottomMenu"
             class="p-ripple flex align-items-center justify-content-center w-3rem h-3rem mx-auto border-round-xl cursor-pointer transition-all text-500 hover:bg-gray-100 hover:text-700"
             [pTooltip]="item.label" 
             tooltipPosition="right"
             (click)="navigate(item.route)">
             <i [class]="item.icon" class="text-xl"></i>
        </div>

        <p-divider styleClass="w-full my-2 px-2"></p-divider>
        
        <p-avatar 
          image="https://primefaces.org/cdn/primeng/images/demo/avatar/amyelsner.png" 
          shape="circle" 
          size="large"
          styleClass="cursor-pointer hover:shadow-2 transition-all"
          pTooltip="Profile"
          tooltipPosition="right">
        </p-avatar>
    </div>
  </div>

  <p-overlayPanel #siteOverlay styleClass="p-0 shadow-6 border-round-xl overflow-hidden">
      <div class="flex flex-column w-14rem z-4000">
          <div class="p-3 bg-gray-50 border-bottom-1 border-gray-200 font-bold text-700">
              Select Site
          </div>
          <div *ngFor="let site of siteOptions"
               class="p-3 cursor-pointer transition-colors border-bottom-1 surface-border hover:surface-100 flex align-items-center justify-content-between"
               [class.surface-100]="selectedSite === site.value"
               [class.text-blue-600]="selectedSite === site.value"
               (click)="selectedSite = site.value; siteOverlay.hide()">
               
               <span>{{ site.label }}</span>
               <i *ngIf="selectedSite === site.value" class="pi pi-check text-blue-600"></i>
          </div>
      </div>
  </p-overlayPanel>

  <p-sidebar [(visible)]="sidebarVisible" styleClass="w-18rem">
    <ng-container *ngTemplateOutlet="fullMenuContent"></ng-container>
  </p-sidebar>

  <div class="flex-1 flex flex-column h-screen overflow-hidden relative">
    
    <div class="md:hidden flex align-items-center justify-content-between p-3 bg-white shadow-1 z-4">
        <div class="flex align-items-center gap-2">
            <p-button icon="pi pi-bars" [text]="true" [rounded]="true" size="large" (click)="sidebarVisible = true"></p-button>
            <span class="font-bold text-xl text-700">
                {{ selectedSite === 'all' ? 'Global' : (selectedSite | uppercase) }}
            </span>
        </div>
        <p-avatar image="https://primefaces.org/cdn/primeng/images/demo/avatar/amyelsner.png" shape="circle"></p-avatar>
    </div>

    <div class="flex-1 overflow-y-auto bg-gray-50 p-4 md:p-6 gap-6">
      <router-outlet></router-outlet>
    </div>
  </div>
</div>